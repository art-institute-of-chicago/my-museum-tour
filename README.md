![Art Institute of Chicago](https://raw.githubusercontent.com/Art-Institute-of-Chicago/template/master/aic-logo.gif)

# My Museum Tour ![Build status badge](https://github.com/art-institute-of-chicago/my-museum-tour/actions/workflows/build.yml/badge.svg)


## Summary of the project

This React app drives the My Museum Tour builder on the main [artic.edu website](https://artic.edu/my-museum-tour). It provided an interactive client-side interface for users to create a My Museum Tour.

## Features

- Uses the API from [artic.edu](https://artic.edu) to:
  - Search artworks
  - `POST` data to the `my-museum-tour` endpoint
- Cypress component testing and integration testing
  - Included as part of the Github Actions workflow

## Overview

This is just a React application, it doesn't contain any styles or images of its own.

It's decoupled from [artic.edu](https://github.com/art-institute-of-chicago/artic.edu), but is intended to be used to embed the app into the [artic.edu website](https://artic.edu). In theory this can be used in other contexts, however it assumes the presence of other assets that exist in order to function correctly, specifically:

- CSS classnames are referenced here, but are defined in artic.edu
- Icons are referenced here, but are defined in artic.edu
- Behaviours (e.g. `pinboard`) are referenced here, but are defined in artic.edu
- Events (e.g. `page:updated`) are referenced here, but are defined in artic.edu

## Configuration

The `<MyMuseumTourBuilder />` React component can take in two `props`.

- `apiSaveEndpoint` (optional) - which should be the path to the `my-museum-tour` save endpoint. If not provided it will default to `/api/v1/my-museum-tour`
- `heroImageId` (optional) - which should be a string forming part of a IIIF image identifier that will be concatenated into a IIIF URL. If not provided there will be no hero image rendered on the customization screen.


## Requirements

- [Node.js / npm](https://docs.npmjs.com/downloading-and-installing-node-js-and-npm)

> [!IMPORTANT]<br>
> Although optional, we recommend using [nvm](https://github.com/nvm-sh/nvm) to match the version of Node used in this project before running the install command, or the npm scripts described below.
>
> If you encounter problems and aren't using the version of Node shown in the [.nvmrc](.nvmrc) file, you should try aligning your node version to this first. This represents a known compatibility with the code here and our dependencies.


## Installing

Install the dependencies in the project root with:

```bash
npm ci
```

## Developing locally

If you want to develop new features on this project locally, there's various commands and actions you can perform using the npm scripts as described below.

A full list of thse scripts is available in [`package.json`](package.json), or by running `npm run`.


> [!NOTE]<br>
> The [`index.html`](./index.html) file links to CSS, JS and icons which can either be symlinked or updated to point to those files from artic.edu


### Compiling and previewing changes

<table width="100%">
  <thead>
    <tr>
      <th width="300px">Command</th>
      <th width="800px">Action</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>npm run dev</code></td>
      <td>Watches files in the <a href="./src"><code>src</code></a> directory for changes and serves a preview at <a href="https://localhost:43110">https://localhost:43110</a> with hot module replacement. You can edit the <a href="./index.html"><code>index.html</code></a> file to update the rendering of this preview (e.g. update the props in <code>MyMuseumTourBuilder</code>)</a></td>
    </tr>
    <tr>
      <td><code>npm run build</code></td>
      <td>Builds the package for use in production. See "<a href="#consuming-this-package">Consuming this package</a>" for how this package can be used</td>
    </tr>
  </tbody>
</table>

> [!IMPORTANT]<br>
> In the current setup you *must* commit the build files

### Running the tests

<table width="100%">
  <thead>
    <tr>
      <th width="300px">Command</th>
      <th width="800px">Action</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>npm run test:gui</code></td>
      <td>Will start the local dev server and run the component tests with the interactive GUI</td>
    </tr>
    <tr>
      <td><code>npm run test</code></td>
      <td>Starts the dev server as above, but instead runs the tests without the GUI</td>
    </tr>
  </tbody>
</table>

### Linting the code

<table width="100%">
  <thead>
    <tr>
      <th width="300px">Command</th>
      <th width="800px">Action</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>npm run lint</code></td>
      <td>Will lint (and fix where possible) all problems in the code</td>
    </tr>
  </tbody>
</table>

## Consuming this package

The expectation is that the code generated by this project will live within [artic.edu](https://www.artic.edu/), but technically the same rules apply if another website or application wants to use it.


### Requirements

- Node.js
- React (>=16)
- ReactDOM (>=16)

### Installation

1. In your `package.json` file add a new dependency that points to this repository:

```json
{
  "my-museum-tour-builder": "git+ssh://git@github.com/art-institute-of-chicago/my-museum-tour.git#main",
}
```

> [!NOTE]<br>
> The fragment (i.e. "#main") of the url shown above refers to the branch. There might be some instances (such as developing a new feature) where you'd like to reference a different branch, which can be achieved by updating this to the corresponding branch and running `npm i my-museum-tour-builder`. You will need to run this command whenever updates are made to the branch shown here, as the `package-lock.json` stores references to specific commits

2. Run `npm i my-museum-tour-builder`

3. The default export for the primary component of this app can be accessed as you would any other npm package using ESModules:
```js
import MyMuseumTourBuilder from 'my-museum-tour-builder';
```

4. Your app is responsible for mounting this component to the DOM using ReactDOM

React 16:
```js
  ReactDOM.render(<MyMuseumTourBuilder/>, container);
```


React > 16:
```js
ReactDOM.createRoot(container).render(<MyMuseumTourBuilder/>);
```


## Contributing

We encourage your contributions. Please fork this repository and make your changes in a separate branch. To better understand how we organize our code, please review our [version control guidelines](https://docs.google.com/document/d/1B-27HBUc6LDYHwvxp3ILUcPTo67VFIGwo5Hiq4J9Jjw).

```bash
# Clone the repo to your computer
git clone git@github.com:art-institute-of-chicago/my-museum-tour.git

# Enter the folder that was created by the clone
cd my-museum-tour

# Start a feature branch
git checkout -b feature/good-short-description

# ... make some changes, commit your code

# Push your branch to GitHub
git push origin feature/good-short-description
```

Then on github.com, create a Pull Request to merge your changes into our
`develop` branch.

This project is released with a Contributor Code of Conduct. By participating in
this project you agree to abide by its [terms](CODE_OF_CONDUCT.md).

We welcome bug reports and questions under GitHub's [Issues](issues). For other concerns, you can reach our engineering team at [engineering@artic.edu](mailto:engineering@artic.edu)

## Acknowledgements

Developed in collaboration with Cogapp and Art Institute of Chicago.
## Licensing

This project is licensed under the [GNU Affero General Public License
Version 3](LICENSE).
